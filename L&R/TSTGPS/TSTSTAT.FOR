        PROGRAM TSTSTAT
C RETREIVES DP EXTENDED STATUS
C RETREIVES GPS UPDATE FLAG
        INTEGER*2 STS,IVAL,UPDFLG
        PARAMETER (STS=0,UPDFLG=#B3)
        CALL GETDPRAM (STS,IVAL)
        PRINT *, 'STATUS =  ',IVAL
        CALL GETDPRAM(UPDFLG,IVAL)
        PRINT *,'UPDATE FLAG =  ',IVAL
        END
C********************* GETDPRAM ***************************
C  RETRIEVES A VALUE FROM DUAL PORT RAM
C  IADD = ADDRESS IN DUAL PORT RAM
C  IVAL = VALUE TO SET IN DUAL PORT RAM
C  CALL GETDPRAM (IADD,IVAL) IADD AND IVAL INTERGER*2
C  READS AND RETURNS IN IVAL.
C  RESPONSE READY MASK = #02
C  EXTENDED STATUS PORT ADDRESS= #03
C  DUAL RAM DATA PORT ADDRESS = #02
C  DUAL RAM ADDRESS PORT ADDRESS = #06
C
        SUBROUTINE GETDPRAM (IADD,IVAL)
        INTEGER*2 IADD,IVAL,IRES,I
        INTEGER*2 SGBASE,MSK,STA,DAT,ADR
        PARAMETER (SGBASE=#02A0,MSK=#02,STA=#03,DAT=#02,ADR=#06)
C
        CALL FETCH (SGBASE+DAT,IRES)    !CLEAR RESPONSE FLAG
        CALL OUTPUT(SGBASE+ADR,IADD)    !SET ADDRESS TO WRITE TO
        DOWHILE (IRES .EQ. 0)           !MAKE SURE VALUE IS SET
            CALL FETCH(SGBASE+STA,IRES)
            IRES = IRES .AND. MSK       !RESPONSE READY MASK
        ENDDO
        DO I=1,200                      !DELAY TO ASSURE SPACING
            CALL FETCH(SGBASE+STA,IRES)
        ENDDO
        ival = 0
        CALL FETCH(SGBASE+DAT,IVAL)     !READ AND RETURN NEW VALUE
C        print *, ival
        END
c ***********************  HZ_200 *************************
        SUBROUTINE HZ_200
        RETURN
        END

